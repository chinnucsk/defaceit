(function(){var b=this,e=b._,g={},l=Array.prototype,o=Object.prototype,p=l.push,k=l.slice,h=l.concat,s=o.toString,t=o.hasOwnProperty,u=l.forEach,w=l.map,A=l.reduce,B=l.reduceRight,C=l.filter,D=l.every,r=l.some,v=l.indexOf,E=l.lastIndexOf,o=Array.isArray,G=Object.keys,x=Function.prototype.bind,c=function(f){if(f instanceof c)return f;if(!(this instanceof c))return new c(f);this._wrapped=f};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=c),exports._=
c):b._=c;c.VERSION="1.4.2";var n=c.each=c.forEach=function(f,a,d){if(null!=f)if(u&&f.forEach===u)f.forEach(a,d);else if(f.length===+f.length)for(var b=0,j=f.length;b<j&&a.call(d,f[b],b,f)!==g;b++);else for(b in f)if(c.has(f,b)&&a.call(d,f[b],b,f)===g)break};c.map=c.collect=function(f,a,d){var c=[];if(null==f)return c;if(w&&f.map===w)return f.map(a,d);n(f,function(f,b,j){c[c.length]=a.call(d,f,b,j)});return c};c.reduce=c.foldl=c.inject=function(f,a,d,b){var j=2<arguments.length;null==f&&(f=[]);if(A&&
f.reduce===A)return b&&(a=c.bind(a,b)),j?f.reduce(a,d):f.reduce(a);n(f,function(f,c,m){j?d=a.call(b,d,f,c,m):(d=f,j=!0)});if(!j)throw new TypeError("Reduce of empty array with no initial value");return d};c.reduceRight=c.foldr=function(f,a,d,b){var j=2<arguments.length;null==f&&(f=[]);if(B&&f.reduceRight===B)return b&&(a=c.bind(a,b)),j?f.reduceRight(a,d):f.reduceRight(a);var m=f.length;if(m!==+m)var i=c.keys(f),m=i.length;n(f,function(c,e,h){e=i?i[--m]:--m;j?d=a.call(b,d,f[e],e,h):(d=f[e],j=!0)});
if(!j)throw new TypeError("Reduce of empty array with no initial value");return d};c.find=c.detect=function(f,a,d){var c;F(f,function(f,b,j){if(a.call(d,f,b,j))return c=f,!0});return c};c.filter=c.select=function(f,a,d){var c=[];if(null==f)return c;if(C&&f.filter===C)return f.filter(a,d);n(f,function(f,b,j){a.call(d,f,b,j)&&(c[c.length]=f)});return c};c.reject=function(f,a,d){return c.filter(f,function(f,c,b){return!a.call(d,f,c,b)},d)};c.every=c.all=function(f,a,d){a||(a=c.identity);var b=!0;if(null==
f)return b;if(D&&f.every===D)return f.every(a,d);n(f,function(f,c,j){if(!(b=b&&a.call(d,f,c,j)))return g});return!!b};var F=c.some=c.any=function(f,a,d){a||(a=c.identity);var b=!1;if(null==f)return b;if(r&&f.some===r)return f.some(a,d);n(f,function(f,c,j){if(b||(b=a.call(d,f,c,j)))return g});return!!b};c.contains=c.include=function(f,a){return null==f?!1:v&&f.indexOf===v?-1!=f.indexOf(a):F(f,function(f){return f===a})};c.invoke=function(f,a){var d=k.call(arguments,2);return c.map(f,function(f){return(c.isFunction(a)?
a:f[a]).apply(f,d)})};c.pluck=function(f,a){return c.map(f,function(f){return f[a]})};c.where=function(f,a){return c.isEmpty(a)?[]:c.filter(f,function(f){for(var d in a)if(c.has(a,d)&&a[d]!==f[d])return!1;return!0})};c.max=function(f,a,d){if(!a&&c.isArray(f)&&f[0]===+f[0]&&65535>f.length)return Math.max.apply(Math,f);if(!a&&c.isEmpty(f))return-Infinity;var b={computed:-Infinity,value:-Infinity};n(f,function(f,c,j){c=a?a.call(d,f,c,j):f;c>=b.computed&&(b={value:f,computed:c})});return b.value};c.min=
function(f,a,d){if(!a&&c.isArray(f)&&f[0]===+f[0]&&65535>f.length)return Math.min.apply(Math,f);if(!a&&c.isEmpty(f))return Infinity;var b={computed:Infinity,value:Infinity};n(f,function(f,c,j){c=a?a.call(d,f,c,j):f;c<b.computed&&(b={value:f,computed:c})});return b.value};c.shuffle=function(f){var a,d=0,b=[];n(f,function(f){a=c.random(d++);b[d-1]=b[a];b[a]=f});return b};var y=function(f){return c.isFunction(f)?f:function(a){return a[f]}};c.sortBy=function(f,a,d){var b=y(a);return c.pluck(c.map(f,function(f,
a,c){return{value:f,index:a,criteria:b.call(d,f,a,c)}}).sort(function(f,a){var d=f.criteria,c=a.criteria;if(d!==c){if(d>c||void 0===d)return 1;if(d<c||void 0===c)return-1}return f.index<a.index?-1:1}),"value")};var z=function(f,a,d,c){var b={},j=y(a);n(f,function(a,I){var m=j.call(d,a,I,f);c(b,m,a)});return b};c.groupBy=function(f,a,d){return z(f,a,d,function(f,a,d){(c.has(f,a)?f[a]:f[a]=[]).push(d)})};c.countBy=function(f,a,d){return z(f,a,d,function(f,a){c.has(f,a)||(f[a]=0);f[a]++})};c.sortedIndex=
function(f,a,d,b){for(var d=null==d?c.identity:y(d),a=d.call(b,a),j=0,m=f.length;j<m;){var i=j+m>>>1;d.call(b,f[i])<a?j=i+1:m=i}return j};c.toArray=function(f){return!f?[]:f.length===+f.length?k.call(f):c.values(f)};c.size=function(f){return null==f?0:f.length===+f.length?f.length:c.keys(f).length};c.first=c.head=c.take=function(f,a,d){return null==f?void 0:null!=a&&!d?k.call(f,0,a):f[0]};c.initial=function(f,a,d){return k.call(f,0,f.length-(null==a||d?1:a))};c.last=function(f,a,d){return null==f?
void 0:null!=a&&!d?k.call(f,Math.max(f.length-a,0)):f[f.length-1]};c.rest=c.tail=c.drop=function(f,a,d){return k.call(f,null==a||d?1:a)};c.compact=function(f){return c.filter(f,function(f){return!!f})};var a=function(f,d,b){n(f,function(f){c.isArray(f)?d?p.apply(b,f):a(f,d,b):b.push(f)});return b};c.flatten=function(f,d){return a(f,d,[])};c.without=function(f){return c.difference(f,k.call(arguments,1))};c.uniq=c.unique=function(f,a,d,b){c.isFunction(a)&&(b=d,d=a,a=!1);var d=d?c.map(f,d,b):f,j=[],
m=[];n(d,function(d,b){if(a?!b||m[m.length-1]!==d:!c.contains(m,d)){m.push(d);j.push(f[b])}});return j};c.union=function(){return c.uniq(h.apply(l,arguments))};c.intersection=function(f){var a=k.call(arguments,1);return c.filter(c.uniq(f),function(f){return c.every(a,function(a){return 0<=c.indexOf(a,f)})})};c.difference=function(f){var a=h.apply(l,k.call(arguments,1));return c.filter(f,function(f){return!c.contains(a,f)})};c.zip=function(){for(var f=k.call(arguments),a=c.max(c.pluck(f,"length")),
d=Array(a),b=0;b<a;b++)d[b]=c.pluck(f,""+b);return d};c.object=function(a,d){if(null==a)return{};for(var c={},b=0,j=a.length;b<j;b++)d?c[a[b]]=d[b]:c[a[b][0]]=a[b][1];return c};c.indexOf=function(a,d,b){if(null==a)return-1;var j=0,m=a.length;if(b)if("number"==typeof b)j=0>b?Math.max(0,m+b):b;else return j=c.sortedIndex(a,d),a[j]===d?j:-1;if(v&&a.indexOf===v)return a.indexOf(d,b);for(;j<m;j++)if(a[j]===d)return j;return-1};c.lastIndexOf=function(a,d,b){if(null==a)return-1;var c=null!=b;if(E&&a.lastIndexOf===
E)return c?a.lastIndexOf(d,b):a.lastIndexOf(d);for(b=c?b:a.length;b--;)if(a[b]===d)return b;return-1};c.range=function(a,d,b){1>=arguments.length&&(d=a||0,a=0);for(var b=arguments[2]||1,c=Math.max(Math.ceil((d-a)/b),0),j=0,m=Array(c);j<c;)m[j++]=a,a+=b;return m};var d=function(){};c.bind=function(a,b){var j,m;if(a.bind===x&&x)return x.apply(a,k.call(arguments,1));if(!c.isFunction(a))throw new TypeError;m=k.call(arguments,2);return j=function(){if(!(this instanceof j))return a.apply(b,m.concat(k.call(arguments)));
d.prototype=a.prototype;var c=new d,i=a.apply(c,m.concat(k.call(arguments)));return Object(i)===i?i:c}};c.bindAll=function(a){var d=k.call(arguments,1);0==d.length&&(d=c.functions(a));n(d,function(d){a[d]=c.bind(a[d],a)});return a};c.memoize=function(a,d){var b={};d||(d=c.identity);return function(){var j=d.apply(this,arguments);return c.has(b,j)?b[j]:b[j]=a.apply(this,arguments)}};c.delay=function(a,d){var b=k.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},d)};c.defer=function(a){return c.delay.apply(c,
[a,1].concat(k.call(arguments,1)))};c.throttle=function(a,d){var b,c,j,m,i=0,e=function(){i=new Date;j=null;m=a.apply(b,c)};return function(){var h=new Date,g=d-(h-i);b=this;c=arguments;0>=g?(clearTimeout(j),i=h,m=a.apply(b,c)):j||(j=setTimeout(e,g));return m}};c.debounce=function(a,d,b){var c,j;return function(){var m=this,i=arguments,e=b&&!c;clearTimeout(c);c=setTimeout(function(){c=null;b||(j=a.apply(m,i))},d);e&&(j=a.apply(m,i));return j}};c.once=function(a){var d=!1,b;return function(){if(d)return b;
d=!0;b=a.apply(this,arguments);a=null;return b}};c.wrap=function(a,d){return function(){var b=[a];p.apply(b,arguments);return d.apply(this,b)}};c.compose=function(){var a=arguments;return function(){for(var d=arguments,b=a.length-1;0<=b;b--)d=[a[b].apply(this,d)];return d[0]}};c.after=function(a,d){return 0>=a?d():function(){if(1>--a)return d.apply(this,arguments)}};c.keys=G||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var d=[],b;for(b in a)c.has(a,b)&&(d[d.length]=b);return d};
c.values=function(a){var d=[],b;for(b in a)c.has(a,b)&&d.push(a[b]);return d};c.pairs=function(a){var d=[],b;for(b in a)c.has(a,b)&&d.push([b,a[b]]);return d};c.invert=function(a){var d={},b;for(b in a)c.has(a,b)&&(d[a[b]]=b);return d};c.functions=c.methods=function(a){var d=[],b;for(b in a)c.isFunction(a[b])&&d.push(b);return d.sort()};c.extend=function(a){n(k.call(arguments,1),function(d){for(var b in d)a[b]=d[b]});return a};c.pick=function(a){var d={},b=h.apply(l,k.call(arguments,1));n(b,function(b){b in
a&&(d[b]=a[b])});return d};c.omit=function(a){var d={},b=h.apply(l,k.call(arguments,1)),j;for(j in a)c.contains(b,j)||(d[j]=a[j]);return d};c.defaults=function(a){n(k.call(arguments,1),function(d){for(var b in d)null==a[b]&&(a[b]=d[b])});return a};c.clone=function(a){return!c.isObject(a)?a:c.isArray(a)?a.slice():c.extend({},a)};c.tap=function(a,d){d(a);return a};var j=function(a,d,b,m){if(a===d)return 0!==a||1/a==1/d;if(null==a||null==d)return a===d;a instanceof c&&(a=a._wrapped);d instanceof c&&
(d=d._wrapped);var i=s.call(a);if(i!=s.call(d))return!1;switch(i){case "[object String]":return a==""+d;case "[object Number]":return a!=+a?d!=+d:0==a?1/a==1/d:a==+d;case "[object Date]":case "[object Boolean]":return+a==+d;case "[object RegExp]":return a.source==d.source&&a.global==d.global&&a.multiline==d.multiline&&a.ignoreCase==d.ignoreCase}if("object"!=typeof a||"object"!=typeof d)return!1;for(var e=b.length;e--;)if(b[e]==a)return m[e]==d;b.push(a);m.push(d);var e=0,h=!0;if("[object Array]"==
i){if(e=a.length,h=e==d.length)for(;e--&&(h=j(a[e],d[e],b,m)););}else{var i=a.constructor,g=d.constructor;if(i!==g&&(!c.isFunction(i)||!(i instanceof i&&c.isFunction(g)&&g instanceof g)))return!1;for(var k in a)if(c.has(a,k)&&(e++,!(h=c.has(d,k)&&j(a[k],d[k],b,m))))break;if(h){for(k in d)if(c.has(d,k)&&!e--)break;h=!e}}b.pop();m.pop();return h};c.isEqual=function(a,d){return j(a,d,[],[])};c.isEmpty=function(a){if(null==a)return!0;if(c.isArray(a)||c.isString(a))return 0===a.length;for(var d in a)if(c.has(a,
d))return!1;return!0};c.isElement=function(a){return!!(a&&1===a.nodeType)};c.isArray=o||function(a){return"[object Array]"==s.call(a)};c.isObject=function(a){return a===Object(a)};n("Arguments,Function,String,Number,Date,RegExp".split(","),function(a){c["is"+a]=function(d){return s.call(d)=="[object "+a+"]"}});c.isArguments(arguments)||(c.isArguments=function(a){return!(!a||!c.has(a,"callee"))});"function"!==typeof/./&&(c.isFunction=function(a){return"function"===typeof a});c.isFinite=function(a){return isFinite(a)&&
!isNaN(parseFloat(a))};c.isNaN=function(a){return c.isNumber(a)&&a!=+a};c.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==s.call(a)};c.isNull=function(a){return null===a};c.isUndefined=function(a){return void 0===a};c.has=function(a,d){return t.call(a,d)};c.noConflict=function(){b._=e;return this};c.identity=function(a){return a};c.times=function(a,d,b){for(var c=0;c<a;c++)d.call(b,c)};c.random=function(a,d){null==d&&(d=a,a=0);return a+(0|Math.random()*(d-a+1))};var m={escape:{"&":"&amp;",
"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};m.unescape=c.invert(m.escape);var i={escape:RegExp("["+c.keys(m.escape).join("")+"]","g"),unescape:RegExp("("+c.keys(m.unescape).join("|")+")","g")};c.each(["escape","unescape"],function(a){c[a]=function(d){return null==d?"":(""+d).replace(i[a],function(d){return m[a][d]})}});c.result=function(a,d){if(null==a)return null;var b=a[d];return c.isFunction(b)?b.call(a):b};c.mixin=function(a){n(c.functions(a),function(d){var b=c[d]=a[d];c.prototype[d]=
function(){var a=[this._wrapped];p.apply(a,arguments);a=b.apply(c,a);return this._chain?c(a).chain():a}})};var J=0;c.uniqueId=function(a){var d=J++;return a?a+d:d};c.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;c.template=function(a,d,b){var b=c.defaults({},b,c.templateSettings),j=RegExp([(b.escape||H).source,(b.interpolate||
H).source,(b.evaluate||H).source].join("|")+"|$","g"),m=0,i="__p+='";a.replace(j,function(d,b,c,j,e){i+=a.slice(m,e).replace(L,function(a){return"\\"+K[a]});i+=b?"'+\n((__t=("+b+"))==null?'':_.escape(__t))+\n'":c?"'+\n((__t=("+c+"))==null?'':__t)+\n'":j?"';\n"+j+"\n__p+='":"";m=e+d.length});i+="';\n";b.variable||(i="with(obj||{}){\n"+i+"}\n");i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var e=new Function(b.variable||"obj","_",
i)}catch(h){throw h.source=i,h;}if(d)return e(d,c);d=function(a){return e.call(this,a,c)};d.source="function("+(b.variable||"obj")+"){\n"+i+"}";return d};c.chain=function(a){return c(a).chain()};c.mixin(c);n("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var d=l[a];c.prototype[a]=function(){var b=this._wrapped;d.apply(b,arguments);(a=="shift"||a=="splice")&&b.length===0&&delete b[0];return this._chain?c(b).chain():b}});n(["concat","join","slice"],function(a){var d=l[a];c.prototype[a]=
function(){var a=d.apply(this._wrapped,arguments);return this._chain?c(a).chain():a}});c.extend(c.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this);
(function(){var b=this,e=b.Backbone,g=Array.prototype,l=g.push,o=g.slice,p=g.splice,k;k="undefined"!==typeof exports?exports:b.Backbone={};k.VERSION="0.9.2";var h=b._;!h&&"undefined"!==typeof require&&(h=require("underscore"));k.$=b.jQuery||b.Zepto||b.ender;k.noConflict=function(){b.Backbone=e;return this};k.emulateHTTP=!1;k.emulateJSON=!1;var s=/\s+/,g=k.Events={on:function(a,d,b){var c,i;if(!d)return this;a=a.split(s);for(c=this._callbacks||(this._callbacks={});i=a.shift();)i=c[i]||(c[i]=[]),i.push(d,
b);return this},off:function(a,d,b){var c,i,e;if(!(i=this._callbacks))return this;if(!a&&!d&&!b)return delete this._callbacks,this;for(a=a?a.split(s):h.keys(i);c=a.shift();)if(!(e=i[c])||!d&&!b)delete i[c];else for(c=e.length-2;0<=c;c-=2)d&&e[c]!==d||b&&e[c+1]!==b||e.splice(c,2);return this},trigger:function(a){var d,b,c,i,e,h,g;if(!(b=this._callbacks))return this;g=[];a=a.split(s);i=1;for(e=arguments.length;i<e;i++)g[i-1]=arguments[i];for(;d=a.shift();){if(h=b.all)h=h.slice();if(c=b[d])c=c.slice();
if(c){i=0;for(e=c.length;i<e;i+=2)c[i].apply(c[i+1]||this,g)}if(h){d=[d].concat(g);i=0;for(e=h.length;i<e;i+=2)h[i].apply(h[i+1]||this,d)}}return this}};g.bind=g.on;g.unbind=g.off;var t=k.Model=function(a,d){var b,c=a||{};d&&d.collection&&(this.collection=d.collection);this.attributes={};this._escapedAttributes={};this.cid=h.uniqueId("c");this.changed={};this._changes={};this._pending={};d&&d.parse&&(c=this.parse(c));if(b=h.result(this,"defaults"))c=h.extend({},b,c);this.set(c,{silent:!0});this.changed=
{};this._changes={};this._pending={};this._previousAttributes=h.clone(this.attributes);this.initialize.apply(this,arguments)};h.extend(t.prototype,g,{changed:null,_changes:null,_pending:null,_changing:null,idAttribute:"id",initialize:function(){},toJSON:function(){return h.clone(this.attributes)},sync:function(){return k.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){var d;if(d=this._escapedAttributes[a])return d;d=this.get(a);return this._escapedAttributes[a]=
h.escape(null==d?"":""+d)},has:function(a){return null!=this.get(a)},set:function(a,d,b){var c,i;if(null==a)return this;h.isObject(a)?(i=a,b=d):(i={})[a]=d;var a=b&&b.silent,e=b&&b.unset;i instanceof t&&(i=i.attributes);if(e)for(c in i)i[c]=void 0;if(!this._validate(i,b))return!1;this.idAttribute in i&&(this.id=i[this.idAttribute]);var g=this._changing,k=this.attributes,l=this._escapedAttributes,f=this._previousAttributes||{};for(c in i){d=i[c];if(!h.isEqual(k[c],d)||e&&h.has(k,c))delete l[c],this._changes[c]=
!0;e?delete k[c]:k[c]=d;!h.isEqual(f[c],d)||h.has(k,c)!==h.has(f,c)?(this.changed[c]=d,a||(this._pending[c]=!0)):(delete this.changed[c],delete this._pending[c],g||delete this._changes[c]);g&&h.isEqual(k[c],g[c])&&delete this._changes[c]}a||this.change(b);return this},unset:function(a,d){d=h.extend({},d,{unset:!0});return this.set(a,null,d)},clear:function(a){a=h.extend({},a,{unset:!0});return this.set(h.clone(this.attributes),a)},fetch:function(a){var a=a?h.clone(a):{},d=this,b=a.success;a.success=
function(c,i,e){if(!d.set(d.parse(c,e),a))return!1;b&&b(d,c,a)};return this.sync("read",this,a)},save:function(a,d,b){var c,e,g;null==a||h.isObject(a)?(c=a,b=d):null!=a&&((c={})[a]=d);b=b?h.clone(b):{};if(b.wait){if(!this._validate(c,b))return!1;e=h.clone(this.attributes)}a=h.extend({},b,{silent:!0});if(c&&!this.set(c,b.wait?a:b)||!c&&!this._validate(null,b))return!1;var k=this,l=b.success;b.success=function(a,d,e){g=!0;d=k.parse(a,e);b.wait&&(d=h.extend(c||{},d));if(!k.set(d,b))return!1;l&&l(k,a,
b)};d=this.sync(this.isNew()?"create":"update",this,b);!g&&b.wait&&(this.clear(a),this.set(e,a));return d},destroy:function(a){var a=a?h.clone(a):{},d=this,b=a.success,c=function(){d.trigger("destroy",d,d.collection,a)};a.success=function(e){(a.wait||d.isNew())&&c();b&&b(d,e,a)};if(this.isNew())return a.success(),!1;var e=this.sync("delete",this,a);a.wait||c();return e},url:function(){var a=h.result(this,"urlRoot")||h.result(this.collection,"url")||z();return this.isNew()?a:a+("/"===a.charAt(a.length-
1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(a){var d=this._changing,b=this._changing={},c;for(c in this._changes)this._pending[c]=!0;var e=this._changes;this._changes={};var g=[];for(c in e)b[c]=this.get(c),g.push(c);for(var e=0,k=g.length;e<k;e++)this.trigger("change:"+g[e],this,b[g[e]],a);if(d)return this;for(;!h.isEmpty(this._pending);){this._pending={};
this.trigger("change",this,a);for(c in this.changed)!this._pending[c]&&!this._changes[c]&&delete this.changed[c];this._previousAttributes=h.clone(this.attributes)}this._changing=null;return this},hasChanged:function(a){return null==a?!h.isEmpty(this.changed):h.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?h.clone(this.changed):!1;var d,b=!1,c=this._previousAttributes,e;for(e in a)if(!h.isEqual(c[e],d=a[e]))(b||(b={}))[e]=d;return b},previous:function(a){return null==
a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return h.clone(this._previousAttributes)},isValid:function(a){return!this.validate||!this.validate(this.attributes,a)},_validate:function(a,d){if(d&&d.silent||!this.validate)return!0;var a=h.extend({},this.attributes,a),b=this.validate(a,d);if(!b)return!0;d&&d.error&&d.error(this,b,d);this.trigger("error",this,b,d);return!1}});var u=k.Collection=function(a,d){d||(d={});d.model&&(this.model=d.model);void 0!==
d.comparator&&(this.comparator=d.comparator);this._reset();this.initialize.apply(this,arguments);a&&(d.parse&&(a=this.parse(a)),this.reset(a,{silent:!0,parse:d.parse}))};h.extend(u.prototype,g,{model:t,initialize:function(){},toJSON:function(a){return this.map(function(d){return d.toJSON(a)})},sync:function(){return k.sync.apply(this,arguments)},add:function(a,d){var b,c,e,g=d&&d.at,a=h.isArray(a)?a.slice():[a];b=0;for(c=a.length;b<c;b++)if(!(a[b]=this._prepareModel(a[b],d)))throw Error("Can't add an invalid model to a collection");
for(b=a.length-1;0<=b;b--)c=a[b],(e=null!=c.id&&this._byId[c.id])||this._byCid[c.cid]?(d&&d.merge&&e&&e.set(c,d),a.splice(b,1)):(c.on("all",this._onModelEvent,this),this._byCid[c.cid]=c,null!=c.id&&(this._byId[c.id]=c));this.length+=a.length;b=[null!=g?g:this.models.length,0];l.apply(b,a);p.apply(this.models,b);this.comparator&&null==g&&this.sort({silent:!0});if(d&&d.silent)return this;for(;c=a.shift();)c.trigger("add",c,this,d);return this},remove:function(a,d){var b,c,e,g;d||(d={});a=h.isArray(a)?
a.slice():[a];b=0;for(c=a.length;b<c;b++)if(g=this.getByCid(a[b])||this.get(a[b]))delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,d.silent||(d.index=e,g.trigger("remove",g,this,d)),this._removeReference(g);return this},push:function(a,d){a=this._prepareModel(a,d);this.add(a,d);return a},pop:function(a){var d=this.at(this.length-1);this.remove(d,a);return d},unshift:function(a,d){a=this._prepareModel(a,d);this.add(a,h.extend({at:0},d));return a},
shift:function(a){var d=this.at(0);this.remove(d,a);return d},slice:function(a,d){return this.models.slice(a,d)},get:function(a){return null==a?void 0:this._byId[null!=a.id?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},where:function(a){return h.isEmpty(a)?[]:this.filter(function(d){for(var b in a)if(a[b]!==d.get(b))return!1;return!0})},sort:function(a){if(!this.comparator)throw Error("Cannot sort a set without a comparator");h.isString(this.comparator)||
1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(h.bind(this.comparator,this));(!a||!a.silent)&&this.trigger("reset",this,a);return this},pluck:function(a){return h.invoke(this.models,"get",a)},reset:function(a,d){for(var b=0,c=this.models.length;b<c;b++)this._removeReference(this.models[b]);this._reset();a&&this.add(a,h.extend({silent:!0},d));(!d||!d.silent)&&this.trigger("reset",this,d);return this},fetch:function(a){a=a?h.clone(a):{};void 0===a.parse&&(a.parse=
!0);var d=this,b=a.success;a.success=function(c,e,g){d[a.add?"add":"reset"](d.parse(c,g),a);b&&b(d,c,a)};return this.sync("read",this,a)},create:function(a,d){var b=this,d=d?h.clone(d):{},a=this._prepareModel(a,d);if(!a)return!1;d.wait||b.add(a,d);var c=d.success;d.success=function(a,d,e){e.wait&&b.add(a,e);c&&c(a,d,e)};a.save(null,d);return a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},chain:function(){return h(this.models).chain()},_reset:function(){this.length=
0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(a,d){if(a instanceof t)return a.collection||(a.collection=this),a;d||(d={});d.collection=this;var b=new this.model(a,d);return!b._validate(b.attributes,d)?!1:b},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,e){("add"===a||"remove"===a)&&c!==this||("destroy"===a&&this.remove(b,e),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],
null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});h.each("forEach,each,map,collect,reduce,foldl,inject,reduceRight,foldr,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortedIndex,toArray,size,first,head,take,initial,rest,tail,last,without,indexOf,shuffle,lastIndexOf,isEmpty".split(","),function(a){u.prototype[a]=function(){var b=o.call(arguments);b.unshift(this.models);return h[a].apply(h,b)}});h.each(["groupBy","countBy","sortBy"],function(a){u.prototype[a]=
function(b,c){var e=h.isFunction(b)?b:function(a){return a.get(b)};return h[a](this.models,e,c)}});var w=k.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,B=/:\w+/g,C=/\*\w+/g,D=/[-{}[\]+?.,\\^$|#\s]/g;h.extend(w.prototype,g,{initialize:function(){},route:function(a,b,c){h.isRegExp(a)||(a=this._routeToRegExp(a));c||(c=this[b]);k.history.route(a,h.bind(function(e){e=this._extractParameters(a,e);c&&c.apply(this,e);
this.trigger.apply(this,["route:"+b].concat(e));k.history.trigger("route",this,b,e)},this));return this},navigate:function(a,b){k.history.navigate(a,b);return this},_bindRoutes:function(){if(this.routes)for(var a,b=h.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])},_routeToRegExp:function(a){a=a.replace(D,"\\$&").replace(A,"(?:$1)?").replace(B,"([^/]+)").replace(C,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var r=k.History=function(){this.handlers=
[];h.bindAll(this,"checkUrl");"undefined"!==typeof window&&(this.location=window.location,this.history=window.history)},v=/^[#\/]|\s+$/,E=/^\/+|\/+$/g,G=/msie [\w.]+/,x=/\/$/;r.started=!1;h.extend(r.prototype,g,{interval:50,getHash:function(a){return(a=(a||this).location.href.match(/#(.*)$/))?a[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){var a=this.location.pathname,c=this.root.replace(x,"");a.indexOf(c)||(a=a.substr(c.length))}else a=this.getHash();
return decodeURIComponent(a.replace(v,""))},start:function(a){if(r.started)throw Error("Backbone.history has already been started");r.started=!0;this.options=h.extend({},{root:"/"},this.options,a);this.root=this.options.root;this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!this.history||!this.history.pushState);var a=this.getFragment(),b=document.documentMode,b=G.exec(navigator.userAgent.toLowerCase())&&
(!b||7>=b);this.root=("/"+this.root+"/").replace(E,"/");b&&this._wantsHashChange&&(this.iframe=k.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a));this._hasPushState?k.$(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!b?k.$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=a;a=this.location;b=a.pathname.replace(/[^\/]$/,
"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&b&&a.hash&&(this.fragment=this.getHash().replace(v,""),this.history.replaceState({},document.title,this.root+this.fragment+a.search));if(!this.options.silent)return this.loadUrl()},stop:function(){k.$(window).unbind("popstate",this.checkUrl).unbind("hashchange",
this.checkUrl);clearInterval(this._checkUrlInterval);r.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a===this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return h.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),
!0})},navigate:function(a,b){if(!r.started)return!1;if(!b||!0===b)b={trigger:b};a=this.getFragment(a||"");if(this.fragment!==a){this.fragment=a;var c=this.root+a;if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else if(this._wantsHashChange)this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace));else return this.location.assign(c);
b.trigger&&this.loadUrl(a)}},_updateHash:function(a,b,c){c?(c=a.href.replace(/(javascript:|#).*$/,""),a.replace(c+"#"+b)):a.hash="#"+b}});k.history=new r;var c=k.View=function(a){this.cid=h.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},n=/^(\S+)\s*(.*)$/,F="model,collection,el,id,attributes,className,tagName".split(",");h.extend(c.prototype,g,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},
dispose:function(){this.undelegateEvents();this.model&&this.model.off&&this.model.off(null,null,this);this.collection&&this.collection.off&&this.collection.off(null,null,this);return this},remove:function(){this.dispose();this.$el.remove();return this},make:function(a,b,c){a=document.createElement(a);b&&k.$(a).attr(b);null!=c&&k.$(a).html(c);return a},setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof k.$?a:k.$(a);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},
delegateEvents:function(a){if(a||(a=h.result(this,"events"))){this.undelegateEvents();for(var b in a){var c=a[b];h.isFunction(c)||(c=this[a[b]]);if(!c)throw Error('Method "'+a[b]+'" does not exist');var e=b.match(n),g=e[1],e=e[2],c=h.bind(c,this),g=g+(".delegateEvents"+this.cid);""===e?this.$el.bind(g,c):this.$el.delegate(e,g,c)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=h.extend({},this.options,a));h.extend(this,h.pick(a,F));
this.options=a},_ensureElement:function(){if(this.el)this.setElement(h.result(this,"el"),!1);else{var a=h.extend({},h.result(this,"attributes"));this.id&&(a.id=h.result(this,"id"));this.className&&(a["class"]=h.result(this,"className"));this.setElement(this.make(h.result(this,"tagName"),a),!1)}}});var y={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};k.sync=function(a,b,c){var e=y[a];h.defaults(c||(c={}),{emulateHTTP:k.emulateHTTP,emulateJSON:k.emulateJSON});var g={type:e,dataType:"json"};
c.url||(g.url=h.result(b,"url")||z());if(!c.data&&b&&("create"===a||"update"===a))g.contentType="application/json",g.data=JSON.stringify(b);c.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{});if(c.emulateHTTP&&("PUT"===e||"DELETE"===e)){g.type="POST";c.emulateJSON&&(g.data._method=e);var l=c.beforeSend;c.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",e);if(l)return l.apply(this,arguments)}}"GET"!==g.type&&!c.emulateJSON&&(g.processData=
!1);var p=c.success;c.success=function(a,f,e){p&&p(a,f,e);b.trigger("sync",b,a,c)};var n=c.error;c.error=function(a){n&&n(b,a,c);b.trigger("error",b,a,c)};return k.ajax(h.extend(g,c))};k.ajax=function(){return k.$.ajax.apply(k.$,arguments)};t.extend=u.extend=w.extend=c.extend=r.extend=function(a,b){var c=this,e;e=a&&h.has(a,"constructor")?a.constructor:function(){c.apply(this,arguments)};h.extend(e,c,b);var g=function(){this.constructor=e};g.prototype=c.prototype;e.prototype=new g;a&&h.extend(e.prototype,
a);e.__super__=c.prototype;return e};var z=function(){throw Error('A "url" property or function must be specified');}}).call(this);DefaceitHome=window.DefaceitHome||!1;Defaceit=window.Defaceit||{};Defaceit.wait=function(b,e,g,l){var g=g||this,l=l||[],o=setInterval(function(){if(0<Defaceit.load.wait.length)for(var p=0;p<Defaceit.load.wait.length;p++)if("Ok"!=Defaceit.load.wait[p])return;window[b]&&(e.call(g,l),clearInterval(o))},100)};
Defaceit.load={wait:[],js:function(b){var e=document.createElement("script");e.setAttribute("src",b);document.getElementsByTagName("head")[0].appendChild(e)},css:function(b){var e=document.createElement("link");e.rel="stylesheet";e.type="text/css";e.href=b;document.getElementsByTagName("head")[0].appendChild(e)},image:function(b){this.wait=this.wait||[];var e=this.wait.length,g=document.createElement("img");g.src=b;this.wait[e]=b;document.getElementsByTagName("head")[0].appendChild(g);var l=this;
g.onload=function(){l.wait[e]="Ok"}}};Defaceit.extend=function(b,e){var g=function(){this.initialize.apply(this,arguments)};g.prototype=_.extend({},b.prototype,e);g.prototype.parent=b.prototype;return g};Defaceit.merge=function(b,e){return jQuery.merge(b,e)};Defaceit.request=function(b){var e=document.createElement("script");e.setAttribute("src",b);document.getElementsByTagName("head")[0].appendChild(e)};callbacks=[];
function request(b){var e=document.createElement("script");e.setAttribute("src",b);document.getElementsByTagName("head")[0].appendChild(e)}function defaceit(b){callback=callbacks[0];callback[0].call(callback[1],b)}Defaceit.CrossDomainRequest=function(b){this.url=b;this.create_iframe();this.create_form(b)};
Defaceit.CrossDomainRequest.prototype={create_iframe:function(){if(!document.getElementById("coaframe")){var b=document.createElement("iframe");b.name="coaframe";b.style.visibility="hidden";b.style.position="absolute";b.style.left=b.style.top="0px";b.height=width="1px";b.id="coaframe";document.getElementsByTagName("body")[0].appendChild(b)}},create_form:function(b){var e=document.getElementById("coaform");if(e){for(;e.firstChild;)e.removeChild(e.firstChild);this.form=e}else e=this.form=document.createElement("form"),
e.style.display="none",e.id="coaform",e.enctype="multipart/form-data",e.method="POST",e.action=b,e.target="coaframe",e.setAttribute("target","coaframe"),document.body.appendChild(e)},add:function(b,e){var g=document.createElement("input");g.type="hidden";g.name=b;g.value=e;this.form.appendChild(g)},request:function(b,e){this.form.submit();var g=setInterval(function(){""!=location.hash&&"#none"!=location.hash&&(b.call(e,location.hash),location.hash="none",clearInterval(g))},200)}};
Defaceit.Screen={border:10,height:function(){return jQuery(window).height()},width:function(){return jQuery(window).width()},scroll_top:function(){return jQuery(window).scrollTop()}};Defaceit.Session=function(b){this.resource=b};Defaceit.Session.prototype={sign_in:!1,check_status:function(b){this.sign_in=!0;request(this.resource+"/show",function(e){null==e.data.key&&(this.sign_in=!1);this.data=e.data;b.call(this)},this)},signed_in:function(){return this.key?!0:!1}};
Defaceit.Display={width:function(){return jQuery(window).width()},height:function(){return jQuery(window).height()}};
Defaceit.Window||(Defaceit.Window={},Defaceit.Window.Simple=function(b){this.initialize(b)},Defaceit.Window.Simple.create=function(b){return new Defaceit.Window.Simple(b)},Defaceit.Window.Simple.prototype={wnd_handler:null,wnd_container:null,content_handler:null,config:{},initialize:function(b){b=this.configure(b);this.create_window();this.apply_title(b.title);this.apply_content(b.content);this.apply_buttons(b.buttons);this.modify(b.geometry)},configure:function(b){this.config=b||{};this.config.plugins=
this.config.plugins||{};this.config.geometry=this.config.geometry||[];this.config.buttons=this.config.buttons||[];return this.config},modify:function(b){if(!b||!b.length)return!1;for(var e=0;e<b.length;e++){var g=b[e],l=g.split(":"),g=l[0],l=1<l.length?l.slice(1):[];jQuery.isFunction(g)&&g.call(this)||this[g]&&this[g].apply(this,l)}},position:function(b,e){this.config.pX=b||this.config.pX;this.config.pY=e||this.config.pY;this.wnd_handler.css({left:this.config.pX,top:this.config.pY})},create_window:function(){(this.wnd_handler=
jQuery("<div>")).addClass("dtWindow").appendTo("body");(this.wnd_container=jQuery("<div>")).addClass("dtWindowContainer").appendTo(this.wnd_handler)},apply_title:function(b){if(!b)return!1;this.title=b;b=jQuery("<div>").html(b).addClass("dtWindowTitle");b.appendTo(this.wnd_container)},apply_content:function(b){if(!b)return!1;this.content=b;return this.content_handler&&this.content_handler.html(this.content)||(this.content_handler=jQuery("<div>").addClass("dtWindowContent").html(b).appendTo(this.wnd_container))},
apply_buttons:function(b){function e(b){var e=jQuery("<a>").attr("href","#").addClass("dtWindowButton").html(b.text);b.handler&&e.click(function(){b.handler.call(l);return!1});b.text&&e.attr("value",b.text);return e}if(!b||!b.length)return!1;for(var g=this.button_handler=jQuery("<div>").addClass("dtWindowButtons"),l=this,o=0;o<b.length;o++)g.append(e(b[o]));g.appendTo(this.wnd_container)},hide:function(){this.wnd_handler.hide()},show:function(){this.wnd_handler.show()},width:function(b){this.config.width=
parseInt(b||this.config.width);this.config.width&&this.wnd_handler.css({width:this.config.width})},height:function(b){this.config.height=parseInt(b||this.config.height);this.config.height&&this.wnd_handler.css({height:this.config.height})},fit_to_screen:function(){this.height(Defaceit.Screen.height()-2*Defaceit.Screen.border);this.width(Defaceit.Screen.width()-2*Defaceit.Screen.border);this.wnd_container.css({height:this.wnd_handler.height()-40,padding:20});var b=this.button_handler?this.button_handler.height():
0;this.content_handler.css({height:this.wnd_container.height()-b})},size:function(){this.wnd_container.css({width:this.width,height:this.height})},center:function(){this.config.pX=Math.floor(Defaceit.Screen.width()/2-this.wnd_handler.width()/2);this.config.pY=Math.floor(Defaceit.Screen.height()/2-this.wnd_handler.height()/2);this.position()},deltaXY:function(b,e){b=parseInt(b||0);e=parseInt(e||0);this.config.pX+=b;this.config.pY+=e;this.position()},top:function(){this.config.pY=Defaceit.Screen.border;
this.position()},right:function(){this.config.pX=Defaceit.Screen.width()-this.wnd_handler.width()-Defaceit.Screen.border;this.position()},left:function(){this.config.pX=Defaceit.Screen.border;this.position()},activate:function(){Defaceit.Window.Manager.get_active_window().deactivate();Defaceit.Window.Manager.active=this.nth;this.state=this.show_menu;this.wnd_handler.animate({width:this.width,height:this.height,left:this.width/2,top:this.height/2},"fast");this.wnd_handler.html(this.content)},deactivate:function(){Defaceit.Window.Manager.active=
-1;this.state=this.activate;this.wnd_handler.animate({width:50,height:50,left:this.init_position_x,top:this.init_position_y},"fast");this.wnd_handler.html(this.icon)},show_menu:function(){this.menu=this.menu||jQuery("<div>").addClass("menu").appendTo(this.wnd_handler).html('<a href="#">\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c</a><a href="#">\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c</a><a href="#">\u0423\u0434\u0430\u043b\u0438\u0442\u044c</a>');this.menu.animate({width:"20%"},
"fast");this.state=this.hide_menu},hide_menu:function(){this.menu.animate({width:"0%"},"fast");this.state=this.show_menu}},Defaceit.Window.InputBox=Defaceit.extend(Defaceit.Window.Simple,{configure:function(b){b.handler=b.handler||function(){alert("\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043d\u0435 \u0437\u0430\u0434\u0430\u043d")};this.textarea=jQuery("<TEXTAREA>").addClass("dtWindowInputBoxTextarea");b.content=this.textarea;
b.buttons=[{text:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",handler:b.handler},{text:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",handler:function(){this.wnd_handler.remove()}}];return this.parent.configure(b)},message:function(){return this.textarea.val()}}),Defaceit.Window.Manager={collection:[],create:function(b,e){return new (Defaceit.Window[b]||Defaceit.Window.Simple)(e)},add:function(b){this.collection.push(b);return this.collection.length},get:function(b){return this.collection[b]},
get_active_window:function(){return 0<=Defaceit.Window.Manager.active?this.get(Defaceit.Window.Manager.active):{deactivate:function(){}}}});
Defaceit.Queue||(Defaceit.Queue=function(b){if(this==Defaceit)return b=b||"",Defaceit.Queue.list[b]=Defaceit.Queue.list[b]||new Defaceit.Queue(b),Defaceit.Queue.list[b];this.init(b);return this},Defaceit.Queue.prototype={queue:"",call_id:1,init:function(b){this.queue=b},next_call_id:function(){return this.call_id++},list:function(){this.request("list");return this},push:function(b){return this.request("push",encodeURIComponent(b))},top:function(){this.request("top");return this},last:function(){return this.request("last")},
request:function(b,e){var e=e||"",g=this.next_call_id();1024<e.length?cors_post("http://eservices.defaceit.ru/queue/"+b+"/"+this.queue+"/"+g,"message_text="+encodeURIComponent(e)):Defaceit.request("http://eservices.defaceit.ru/queue/"+b+"/"+this.queue+"/"+g+"/"+e);return g},client:function(b){this.clients=this.clients||[];this.clients.push(b)},client_callback:function(b){b.call_id=parseInt(b.call_id);switch(b.type){case "messages":for(var e=0;e<b.data.length;e++)this.send_message(b.data[e].message_text,
b.data[e]);break;case "message":this.send_message(b.data.message_text,b.data,b);break;case "status":this.send_status_message(b)}},send_status_message:function(b){for(var e=0;e<this.clients.length;e++){var g=this.clients[e];g.queue_status&&g.queue_status(b)}},send_message:function(b,e,g){for(var b=decodeURIComponent(b),l=0;l<this.clients.length;l++){var o=this.clients[l];o.queue_message&&o.queue_message(b,e,g)}}},Defaceit.Queue.list=Defaceit.Queue.list||{},Defaceit.Queue.callbacks=Defaceit.Queue.callbacks||
[],Defaceit.Queue.response=function(b){Defaceit.Queue.list[b.queue_name].client_callback(b)});actions={};fire=function(b,e,g,l){actions[b]&&actions[b][e]&&actions[b][e][0]&&actions[b][e][0].call(actions[b][e][1],g,l)};function q(b,e){Defaceit.Queue(b).client({queue_message:function(e,l){fire(b,"message",e,l)},queue_status:function(e){fire(b,e.result,e,e)}});actions[b]=actions[b]||{};return{on:function(g,l){actions[b][g]=[e[l],e];return this}}}
function cors_post(b,e){var g=function(b,e){var g=new XMLHttpRequest;"withCredentials"in g?g.open(b,e,!0):"undefined"!=typeof XDomainRequest?(g=new XDomainRequest,g.open(b,e)):g=null;return g}("POST",b);if(!g)throw Error("CORS not supported");g.setRequestHeader("Content-type","application/x-www-form-urlencoded");g.setRequestHeader("Content-length",e.length);g.setRequestHeader("Connection","close");g.onload=function(){eval(g.responseText)};g.onerror=function(){console.log("There was an error!")};g.send(e)}
window.jQuery||Defaceit.load.js("http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js");Defaceit.load.css("http://defaceit.ru/defaceit/tools/css/defaceit.css");window.jQuery||Defaceit.load.js("http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js");
queue=function(){var b=/\/queue\/(.*)$/.exec(document.location),b=b[1]||"default";Defaceit.Queue(b).client({queue_message:function(b){$("#messages").append($("<xmp>").css({"font-size":"12px","line-height":"12px","background-color":"lightgoldenrodyellow",padding:"15px",border:"1px solid palegoldenrod","box-shadow":"0 0 16px -16px #000000 inset"}).html(b))},queue_status:function(){Defaceit.Queue(b).top()}});Defaceit.Queue(b).list();Defaceit.load.css("http://defaceit.ru/defaceit/tools/css/defaceit.css");
Defaceit.Window.Manager.create("Simple",{content:$("<div>").attr("id","messages"),title:"\u043e\u0447\u0435\u0440\u0435\u0434\u044c: "+b,geometry:["fit_to_screen","top","left","show"],buttons:[{text:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",handler:function(){Defaceit.Window.Manager.create("InputBox",{geometry:["width:400","center","show"],handler:function(){Defaceit.Queue(b).push(this.message());this.hide()}})}}]})};Defaceit.wait("jQuery",queue,this,["jQuery"]);
